{% extends 'base.html' %}

{% load static %}

{% block content %}
   <div class="main_body">
      <div id="interaction" class="interact">
        <div class="info-title">Selection panel</div>
        <input id="Chassis" type="button" class="button_chassis" onclick="hideShow()" value="Chassis"/> 
        <input type="text" onfocus="blur()" style="border:none" class="txtvalue_chassis" autocomplete="off" onkeydown="return false;" id="txtvalue" class="input_box_chassis"/>
        <button  id="Delete selection" onclick="delete_chassis()" class="btn"><i class="fa fa-close"></i></button>
        
        <div id="dialogo" class ="hidden" style="display: none;">
            <select id="list-container" autocomplete="off" onchange="ddlselect();">
                <option selected="selected" disabled="disabled">-- Select your chassis--</option>
                <option id="BSUB">Bacilus Subtilis</option>
                <option id="GCF_000008765">Clostridium acetobutylicum</option>
                <option id="GCF_001638825">Deinococcus radiodurans</option>
                <option id="ECOLI">Escherichia Coli</option>
                <option id="GCF_000007985">Geobacter sulfurreducens</option>
                <option id="GCF_000238715">Klebsiella sp. 4_1_44FAA</option>
                <option id="PPUT160488">Pseudomonas putida</option>
                <option id="YEAST">Saccharomyces cerevisiae</option>
                <option id="GCF_00014615">Shewanella oneidensis</option>
                <option id="SCO">Streptomyces spp.</option>
                <option id="GCF_000340785">Synechocystis spp.</option>
                <option id="YARROWIA">Yarrowia lipolytica</option>
            </select>
         

            <script>
               function ddlselect()
               {
                   var d=document.getElementById("list-container");
                   var displaytext=d.options[d.selectedIndex].text;
                   $("#list-container").change(function() {
                     console.log( $(this).children(":selected").attr("id"));
                   orgid = $(this).children(":selected").attr("id");
                   });
                   //var displaytext="Chassis: "+d.options[d.selectedIndex].text+"  Taxon_ID: ";
                   document.getElementById("txtvalue").value=displaytext;
                   console.log(displaytext)
                   $("#dialogo").dialog("close");
                   var display =1;
                  
                           }
           </script>
         </div>
        <input type="button" data-toggle="modal" href="#myModal" class="button_producibles" id="producibles" value="Producible"/><input type="text" onfocus="blur()" style="border:none" class="txtvalue_prod" prod_id="" autocomplete="off" onkeydown="return false;" id="txtvalue_prod"/>
        <button  id="Delete selection" onclick= "delete_producible()">
          <img src="{% static 'website/icon/arrow_button.svg' %}" alt="Select"></img>
        </button>
        
        <input type="button" data-toggle="modal" href="#mynewModal" class="button_detectables" id="detectables" value="Detectable"/><input type="text" onfocus="blur()" style="border:none" class="txtvalue_det" det_id="" autocomplete="off" onkeydown="return false;" id="txtvalue_det"/>
        <button  id="Delete selection" onclick= "delete_detectable()" class="btn"><i class="fa fa-close"></i></button>

        <input id="load_pathway" type="button" onclick="show_pathways()" value="Generate" style="margin-top: 10px"/>
        <div id="info_pair">
          <p id="txt_intermediate_compounds">Intermediate compounds:</p>
          <p id="txt_chassis_compounds">Compounds in chassis:</p>
        </div>
        <div id="pathway_selection">
         <div class="info-title">Viewer tools</div>
         <div class="spacer"></div>
         <div id="table_choice">
             <!-- Will be filled by viewer.js -->
         </div>
         <input id="view_all_pathways_button" type="button" value="Show all pathways"/>
         <input id="hide_all_pathways_button" type="button" value="Hide all pathways"/>
         <input id="redraw_pathways_button" type="button" value="Refresh layout"/>
     </div>
</div>
<script>
  $(function(){
      $("#interaction").draggable();
  })
</script>
        <div class="modal fade" id="myModal">
         <div class="modal-dialog modal-lg modal-dialog-centered">
           <div class="modal-content">
             <div class="modal-header">
               <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
             </div>
             <div class="modal-body" id="producibles_modal_table">
             </div>
             <div class="modal-footer">
               <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
             </div>
           </div><!-- /.modal-content -->
         </div><!-- /.modal-dialog -->
         </div><!-- /.modal -->
                                 <script>
                                    function ddlselect_prod()
                                    {
                                       var d=document.getElementById("producibles_table");
                                       for(var i = 0; i < d.rows.length; i++)
                        {
                           d.rows[i].onclick = function()
                           {
                              rIndex = this.rowIndex;
                                 var produc=$(this.cells[0]);
                                    console.log(produc.text());
                                    document.getElementById("txtvalue_prod").value=produc.text();
                                    $("#txtvalue_prod").attr("prod_id",produc.attr("id"));
                                    $('#myModal').modal('hide');
                                    $('.modal-backdrop').remove();
                                    let product_chosen= $("#txtvalue_prod").attr("prod_id");
                                    let detect_chosen= $("#txtvalue_det").attr("det_id");
                                    if(product_chosen!="" && detect_chosen!=""){
                                       $.getScript("api/net/"+String(product_chosen)+"/"+String(detect_chosen));
                                    }
                              

                           }
                        }
                                    }

                                 </script>
        <div class="modal fade" id="mynewModal">
         <div class="modal-dialog modal-lg">
           <div class="modal-content">
             <div class="modal-header">
               <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
             </div>
             <div class="modal-body">
               <table class="table table-striped table-hover" id="detectables_modal_table"></table>
               </table>
             </div>
             <div class="modal-footer">
               <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
             </div>
           </div><!-- /.modal-content -->
         </div><!-- /.modal-dialog -->
         </div><!-- /.modal -->
                                 <script>
                                    function ddlselect_det()
                                    {
                                       var d=document.getElementById("detectables_table");
                                       for(var i = 0; i < d.rows.length; i++)
                        {
                           d.rows[i].onclick = function()
                           {
                                 rIndex = this.rowIndex;
                                 var detec=$(this.cells[0]);
                                    console.log(detec.text());
                                    document.getElementById("txtvalue_det").value=detec.text();
                                    $("#txtvalue_det").attr("det_id",detec.attr("id"));
                                    $('#mynewModal').modal('hide');
                                    $('.modal-backdrop').remove();
                                    let product_chosen= $("#txtvalue_prod").attr("prod_id");
                                    let detect_chosen= $("#txtvalue_det").attr("det_id");
                                    if(product_chosen!="" && detect_chosen!=""){
                                       $.getScript("api/net/"+String(product_chosen)+"/"+String(detect_chosen));
                                    }
                              

                           }
                        }
                                    }

                                 </script>
   
 

    <div class="visualizer" id="base">
   

      <script>
         $( function() {
             $( "#base" ).load( "{% static 'website/files/body_viz.html' %}" );
         });
       </script>  
    </div>

    <div style="clear:both">
    
    </div>

   
</div>



<!-- Javascript files-->
<script src="{% static 'website/js/jquery.min.js'%}"type="text/javascript"></script>
      <script src="{% static 'website/js/bootstrap.bundle.min.js'%}"></script>
      <script src="{% static 'website/js/bootstrap.min.js'%}"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.8.1/baguetteBox.min.js"></script>
      <script src="{% static 'website/js/chroma.min.js'%}"></script>
      <script src="{% static 'website/js/dagre.js'%}"></script>
      <script src="{% static 'website/js/Home.js'%}"></script>
      <script src="{% static 'website/js/Producibles.js'%}"></script>
      <script src="{% static 'website/js/jquery-ui.js'%}"></script>
      <script src="{% static 'website/js/jquery-ui.min.js'%}"></script>
      <!-- <script src="{% static 'website/js/buttons.jqueryui.min.js'%}"></script> -->
      <!-- Table sorter -->
      <script src="{% static 'website/js/jquery.tablesorter.min.js'%}"></script>

      {% endblock %}
